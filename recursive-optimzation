1) Try to reduce to tail call optimization
2) Replace self-call with loop
